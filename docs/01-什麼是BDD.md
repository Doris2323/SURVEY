# 什麼是 BDD？

## 簡介

**BDD（Behavior-Driven Development，行為驅動開發）** 是一種軟體開發方法論，強調透過自然語言描述系統行為來驅動開發。

## TDD vs BDD

| 特性 | TDD | BDD |
|------|-----|-----|
| 關注點 | 單元測試 | 行為規格 |
| 語言 | 程式碼 | 自然語言 |
| 對象 | 開發者 | 開發者 + 利害關係人 |
| 粒度 | 函式級別 | 功能級別 |
| 步驟數 | 3 步驟 | 4 步驟 |

## TDD 的三個步驟

TDD（Test-Driven Development）的核心循環：

```
紅燈 → 綠燈 → 重構
```

1. **紅燈**：寫一個會失敗的測試
2. **綠燈**：寫最少程式碼讓測試通過
3. **重構**：改善程式碼品質

## BDD 的四個步驟

BDD 在 TDD 的基礎上，加入了**綁定**步驟：

```
綁定 → 紅燈 → 綠燈 → 重構
```

### 1. 綁定（Binding）

將 Gherkin Feature 對應到 Step Definition。

```
Feature 檔案 → Step Definition 樣板
```

這個階段的目的是：
- 用自然語言定義行為規格
- 建立測試與程式碼的連結
- 確保所有場景都有對應的測試骨架

### 2. 紅燈（Red）

確認測試**以正確的方式失敗**。

```
執行測試 → 測試失敗（紅燈）
```

這個階段的目的是：
- 確認測試邏輯正確
- 確認測試能偵測到缺失的功能
- **不寫任何實作程式碼**

### 3. 綠燈（Green）

寫**最少的程式碼**讓測試通過。

```
寫最少程式碼 → 執行測試 → 測試通過（綠燈）
```

這個階段的原則：
- 只寫讓測試通過的程式碼
- 不要過度設計
- 可以「作弊」（hardcode）

### 4. 重構（Refactor）

在測試保護下**改善程式碼品質**。

```
改善程式碼 → 執行測試 → 測試仍然通過
```

這個階段的目標：
- 消除重複
- 改善命名
- 優化結構
- **不改變外部行為**

## 為什麼用 BDD？

### 1. 共同語言

開發者、測試人員、產品經理可以用同一份文件溝通。

### 2. 活文件

測試就是規格，規格就是測試。程式碼更新時，文件自動保持同步。

### 3. 減少誤解

用具體的例子描述需求，比抽象的規格更不容易產生誤解。

### 4. 測試優先

強制先思考「要做什麼」，再思考「怎麼做」。

## Gherkin 語法

BDD 使用 **Gherkin** 語法撰寫 Feature 檔案：

```gherkin
# language: zh-TW
功能: 打卡記錄
  作為一個員工
  我想要記錄上下班打卡時間
  以便追蹤我的工時

  場景: 新增上班打卡
    假設 系統已準備好「打卡記錄」工作表
    當 我執行「IN」打卡
    那麼 打卡結果應該成功
    而且 工作表應該有 1 筆記錄
```

這個語法的優點：
- 使用中文，容易理解
- 結構清晰（假設 → 當 → 那麼）
- 可直接執行測試

## 在這個 Workshop

你將學習 BDD 的四個步驟：

1. **綁定**：撰寫 Feature，將 Gherkin 對應到 Step Definition
2. **紅燈**：確認測試以正確的方式失敗
3. **綠燈**：用 AI 幫你寫最少實作讓測試通過
4. **重構**：在測試保護下改善程式碼品質

## 下一步

閱讀 [02-如何撰寫Feature.md](./02-如何撰寫Feature.md) 學習 Gherkin 語法。
