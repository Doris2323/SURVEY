@ignore
Feature: 新增交通方式

  Background:
    Given 系統中有以下旅遊計畫：
      | id | 計畫名稱       | 參與人數 |
      | 1  | 2024 東京自由行 | 2        |

  # ========== 前置條件 ==========

  Rule: 前置（狀態）- 旅遊計畫必須已存在

    Example: 旅遊計畫不存在時新增失敗
      When 用戶 "Alice" 在旅遊計畫 999 新增交通方式：
        | 交通類型 | 起點   | 終點   | 費用 |
        | 飛機     | 台北   | 東京   | 8000 |
      Then 操作失敗
      And 錯誤訊息為 "旅遊計畫不存在"

  Rule: 前置（狀態）- 同一計畫內相同類型起點終點不可重複

    Example: 相同交通方式已存在時新增失敗
      Given 旅遊計畫 1 中有以下交通方式：
        | 交通類型 | 起點   | 終點   | 費用 |
        | 飛機     | 台北   | 東京   | 8000 |
      When 用戶 "Alice" 在旅遊計畫 1 新增交通方式：
        | 交通類型 | 起點   | 終點   | 費用 |
        | 飛機     | 台北   | 東京   | 7500 |
      Then 操作失敗
      And 錯誤訊息為 "相同交通方式已存在"

  Rule: 前置（參數）- 交通類型必須提供

    Example: 未提供交通類型時新增失敗
      When 用戶 "Alice" 在旅遊計畫 1 新增交通方式：
        | 交通類型 | 起點   | 終點   | 費用 |
        |          | 台北   | 東京   | 8000 |
      Then 操作失敗
      And 錯誤訊息為 "交通類型必須提供"

  Rule: 前置（參數）- 起點必須提供

    Example: 未提供起點時新增失敗
      When 用戶 "Alice" 在旅遊計畫 1 新增交通方式：
        | 交通類型 | 起點 | 終點   | 費用 |
        | 飛機     |      | 東京   | 8000 |
      Then 操作失敗
      And 錯誤訊息為 "起點必須提供"

  Rule: 前置（參數）- 終點必須提供

    Example: 未提供終點時新增失敗
      When 用戶 "Alice" 在旅遊計畫 1 新增交通方式：
        | 交通類型 | 起點   | 終點 | 費用 |
        | 飛機     | 台北   |      | 8000 |
      Then 操作失敗
      And 錯誤訊息為 "終點必須提供"

  Rule: 前置（參數）- 費用必須大於等於 0

    Example: 費用為負數時新增失敗
      When 用戶 "Alice" 在旅遊計畫 1 新增交通方式：
        | 交通類型 | 起點   | 終點   | 費用 |
        | 飛機     | 台北   | 東京   | -100 |
      Then 操作失敗
      And 錯誤訊息為 "費用必須大於等於 0"

  # ========== 後置條件 ==========

  Rule: 後置（狀態）- 系統應新增一筆交通方式記錄

    Example: 成功新增交通方式
      When 用戶 "Alice" 在旅遊計畫 1 新增交通方式：
        | 交通類型 | 起點   | 終點   | 費用 |
        | 飛機     | 台北   | 東京   | 8000 |
      Then 操作成功
      And 旅遊計畫 1 中應有以下交通方式：
        | 交通類型 | 起點   | 終點   | 費用 |
        | 飛機     | 台北   | 東京   | 8000 |

    Example: 成功新增免費交通方式
      When 用戶 "Alice" 在旅遊計畫 1 新增交通方式：
        | 交通類型   | 起點       | 終點       | 費用 |
        | 飯店接駁車 | 成田機場   | 東京車站   | 0    |
      Then 操作成功
      And 旅遊計畫 1 中應有以下交通方式：
        | 交通類型   | 起點       | 終點       | 費用 |
        | 飯店接駁車 | 成田機場   | 東京車站   | 0    |
